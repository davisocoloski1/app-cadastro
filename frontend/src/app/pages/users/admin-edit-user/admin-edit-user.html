<div class="page-wrapper flex-column align-items-center">
  <div class="container card shadow-sm clients-card p-0" style="max-width: 640px;">
    <div class="card-body p-4 p-md-5">
      <div class="mb-4">
        <h2 class="h4 fw-bold mb-1">Olá, <strong>{{ adminName }}</strong></h2>
        <p class="text-muted">Você está editando a conta de <strong>{{ name }}</strong></p>
      </div>

      <hr class="mb-4" />

      @if (errorMsg) {
        <div class="alert alert-danger mb-4 border-0 shadow-sm">
          <i class="bi bi-exclamation-octagon-fill me-2"></i>
          {{ errorMsg }}
        </div>
      }

      <form [formGroup]="editForm" novalidate>
        <div class="mb-4">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <label class="form-label fw-bold mb-0">Nome completo</label>
            <button type="button" class="btn btn-sm btn-outline-primary" (click)="toggleName()">
              {{ nameDisabled ? 'Editar' : 'Bloquear' }}
            </button>
          </div>
          <input
            type="text"
            formControlName="name"
            class="form-control"
            placeholder="Nome do usuário"
          />
        </div>

        <div class="mb-4">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <label class="form-label fw-bold mb-0">E-mail</label>
            <button type="button" class="btn btn-sm btn-outline-primary" (click)="toggleEmail()">
              {{ emailDisabled ? 'Editar' : 'Bloquear' }}
            </button>
          </div>
          <input
            type="email"
            formControlName="email"
            class="form-control"
            placeholder="E-mail do usuário"
          />
        </div>

        <div class="mb-4">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <label class="form-label fw-bold mb-0">Telefone</label>
            <button type="button" class="btn btn-sm btn-outline-primary" (click)="toggleTelefone()">
              {{ telefoneDisabled ? 'Editar' : 'Bloquear' }}
            </button>
          </div>
          <input
            type="tel"
            formControlName="telefone"
            class="form-control"
            placeholder="(00) 00000-0000"
          />
        </div>

        <div class="mb-4 p-3 bg-light rounded-3 border">
          <div class="d-flex flex-column mb-3">
            <label class="form-label fw-bold mb-1">Segurança</label>
            <span class="text-muted small">Um link de redefinição será enviado para {{ name }}</span>
          </div>

          @if (successMsg) {
            <div class="alert alert-success py-2 mb-3 border-0 shadow-sm text-center small">
              <i class="bi bi-check-circle-fill me-2"></i>
              {{ successMsg }}
            </div>
          }

          <button
            type="button"
            class="btn btn-outline-dark w-100 fw-bold"
            (click)="enviarAlteracaoSenha()"
            [disabled]="alterarSenhaLoading"
          >
            @if (alterarSenhaLoading) {
              <span class="spinner-border spinner-border-sm me-2"></span>
            }
            {{ alterarSenhaLoading ? 'Enviando email...' : 'Redefinir Senha via E-mail' }}
          </button>
        </div>

        <div class="d-flex gap-3 mt-5">
          <button
            type="button"
            class="btn btn-light border flex-fill py-2 fw-bold"
            (click)="getUserById(user.id!)"
          >
            Reverter
          </button>

          <button
            type="submit"
            class="btn btn-primary flex-fill py-2 fw-bold"
            (click)="salvarAlteracoes()"
            [disabled]="saveLoading"
          >
            @if (saveLoading) {
              <span class="spinner-border spinner-border-sm me-2"></span>
            }
            {{ saveLoading ? 'Salvando...' : 'Salvar Alterações' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>  