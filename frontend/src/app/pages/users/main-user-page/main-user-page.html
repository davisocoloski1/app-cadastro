<div class="page-wrapper d-flex justify-content-center align-items-center py-5">
  <div class="container card shadow-sm clients-card p-0" style="max-width: 640px;">
    
    @if (stateMsg) {
      <div class="px-4 pt-4">
        <div class="alert alert-info border-0 shadow-sm py-2 mb-0">
          <i class="bi bi-info-circle-fill me-2"></i>{{ stateMsg }}
        </div>
      </div>
    }

    <div class="card-body p-4 p-md-5">
      <div class="d-flex justify-content-between align-items-start mb-4 gap-3">
        <div>
          <h1 class="h4 fw-bold mb-1">
            Olá, <span class="text-primary">{{ name }}</span>
          </h1>
          <p class="text-muted small mb-0">Bem-vindo à área de edição de conta</p>

          @if (!isUserConfirmed) {
            <div class="account-warning-banner mt-3 d-flex justify-content-between align-items-center gap-3">
              <span class="small fw-medium">Sua conta ainda não foi verificada.</span>
              <button
                type="button"
                class="btn btn-sm btn-warning fw-bold px-3"
                (click)="enviarCodigoConfirmacao()"
              >
                @if (verifyLoading) {
                  <span class="spinner-border spinner-border-sm" role="status"></span>
                }
                {{ verifyLoading ? '' : 'Verificar agora' }}
              </button>
            </div>
          }
        </div>

        <button type="button" class="btn btn-sm btn-outline-danger px-3 fw-bold" (click)="logout()">
          Sair
        </button>
      </div>

      <hr class="my-4 opacity-10" />

      @if (errorMsg) {
        <div class="alert alert-danger border-0 shadow-sm py-2 mb-4">
          <i class="bi bi-exclamation-octagon-fill me-2"></i>{{ errorMsg }}
        </div>
      }

      <form [formGroup]="editForm" novalidate>
        <div class="mb-4">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <label class="form-label fw-bold small mb-0">Seu nome</label>
            <button type="button" class="btn btn-link btn-sm text-decoration-none p-0 small fw-bold" (click)="toggleName()">
              {{ nameDisabled ? 'Editar' : 'Bloquear' }}
            </button>
          </div>
          <input type="text" formControlName="name" class="form-control" placeholder="Seu nome" />
        </div>

        <div class="mb-4">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <label class="form-label fw-bold small mb-0">Seu e-mail</label>
            <button type="button" class="btn btn-link btn-sm text-decoration-none p-0 small fw-bold" (click)="toggleEmail()">
              {{ emailDisabled ? 'Editar' : 'Bloquear' }}
            </button>
          </div>
          <input type="email" formControlName="email" class="form-control" placeholder="Seu e-mail" />
        </div>

        <div class="mb-4">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <label class="form-label fw-bold small mb-0">Seu telefone</label>
            <button type="button" class="btn btn-link btn-sm text-decoration-none p-0 small fw-bold" (click)="toggleTelefone()">
              {{ telefoneDisabled ? 'Editar' : 'Bloquear' }}
            </button>
          </div>
          <input type="tel" formControlName="telefone" class="form-control" placeholder="Seu telefone" />
        </div>

        <div class="mb-4 p-3 bg-light rounded-3 border">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <label class="form-label fw-bold small mb-0">Segurança</label>
            <span class="text-muted smaller">Alteração protegida</span>
          </div>
          <button type="button" class="btn btn-white border w-100 fw-bold shadow-sm" (click)="alterarSenhaRouter()">
            Alterar senha de acesso
          </button>
        </div>

        <div class="d-flex gap-3 pt-2">
          <button type="button" class="btn btn-light border flex-fill fw-bold" (click)="getUser()">
            Reverter
          </button>
          <button type="button" class="btn btn-primary flex-fill fw-bold" (click)="salvarAlteracoes()">
            @if (saveLoading) {
              <span class="spinner-border spinner-border-sm me-2" role="status"></span>
            }
            {{ saveLoading ? 'Salvando...' : 'Salvar Alterações' }}
          </button>
        </div>
      </form>

      <div class="mt-5 pt-4 border-top">
        <div class="d-flex justify-content-between align-items-center bg-danger-subtle p-3 rounded-3 border border-danger-subtle">
          <div>
            <h2 class="h6 fw-bold mb-1 text-danger">Deletar conta</h2>
            <p class="mb-0 text-muted smaller">
              Esta ação removerá permanentemente todos os seus dados.
            </p>
          </div>
          <button type="button" class="btn btn-sm btn-danger px-3 fw-bold shadow-sm" (click)="toggleDeleteCard()" [disabled]="showDeleteCard">
            Deletar
          </button>
        </div>
      </div>

      @if (showDeleteCard) {
        <div class="mt-4">
          <app-deletar-user-card (hideCard)="showDeleteCard = $event"></app-deletar-user-card>
        </div>
      }
    </div>
  </div>
</div>